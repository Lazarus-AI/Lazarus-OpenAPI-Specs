{
  "openapi": "3.1.0",
  "info": {
    "title": "RikAI 2",
    "termsOfService": "https://www.lazarusai.com/legal",
    "contact": {
      "name": "Lazarus IT",
      "url": "https://lazarus-ai.atlassian.net/servicedesk/customer/portal/8",
      "email": "support@lazarusai.com"
    },
    "license": {
      "name": "Get Lazarus",
      "url": "https://emvnha23ura.typeform.com/lazarus-rikai?typeform-source=dashboard.lazarusai.com"
    },
  },
  "paths": {
    "/rikai2": {
      "post": {
        "summary": "RikAI 2",
        "description": "Supported input files should support standard file formats (Formats are checked with file header bytes):\n- PDF\n- JPG/JPEG\n- PNG\n- TIFF/TIF\n- HEIC",
        "operationId": "rikai2_post",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RikAI2Request"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RikAI2Response"
                }
              }
            }
          },
          "401": {
            "description": "Invalid/Empty License",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal API error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "522": {
            "description": "Model failed",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/status": {
      "get": {
        "summary": "Status",
        "description": "Check the status of app dependencies.",
        "operationId": "status_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/StatusResponse"
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "CPUStats": {
        "properties": {
          "architecture": {
            "type": "string",
            "description": "CPU architecture (e.g. 64bit)"
          },
          "model": {
            "type": "string",
            "description": "Processor model string"
          },
          "physicalCores": {
            "type": "integer",
            "description": "Number of physical CPU cores"
          },
          "logicalCores": {
            "type": "integer",
            "description": "Number of logical CPU cores"
          },
          "utilizationPercent": {
            "type": "number",
            "description": "Current CPU utilization percentage"
          }
        },
        "type": "object",
        "required": [
          "architecture",
          "model",
          "physicalCores",
          "logicalCores",
          "utilizationPercent"
        ],
        "title": "CPUStats",
        "description": "CPU utilization stats."
      },
      "Data": {
        "properties": {
          "question": {
            "type": "string",
            "title": "Question",
            "description": "Question asked"
          },
          "answer": {
            "type": "string",
            "title": "Answer",
            "description": "Answer to appropriate question"
          },
          "confidence": {
            "type": "number",
            "description": "Answer confidence score ranging from 0 to 1."
          },
          "context": {
            "type": "string",
            "description": "Where in the document the answer was found."
          }
        },
        "type": "object",
        "required": [
          "question",
          "answer"
        ],
        "title": "Data",
        "description": "Answer data model for /rikai2 response"
      },
      "DiskStats": {
        "properties": {
          "totalGB": {
            "type": "number",
            "description": "Total disk size in GB"
          },
          "usedGB": {
            "type": "number",
            "description": "Used disk space in GB"
          },
          "usedPercent": {
            "type": "number",
            "description": "Percentage of disk currently used"
          }
        },
        "type": "object",
        "required": [
          "totalGB",
          "usedGB",
          "usedPercent"
        ],
        "title": "DiskStats",
        "description": "Disk usage statistics."
      },
      "GPUStats": {
        "properties": {
          "id": {
            "type": "integer",
            "description": "GPU device ID"
          },
          "name": {
            "type": "string",
            "description": "GPU name"
          },
          "memoryTotalGB": {
            "type": "number",
            "description": "Total GPU memory in GB"
          },
          "memoryAllocatedGB": {
            "type": "number",
            "description": "Memory currently allocated in GB"
          },
          "utilizationPercent": {
              "type": "number",
              "description": "Current GPU utilization percentage"
          }
        },
        "type": "object",
        "required": [
          "id",
          "name",
          "memoryTotalGB",
          "memoryAllocatedGB",
          "utilizationPercent"
        ],
        "title": "GPUStats",
        "description": "GPU device utilization stats."
      },
      "MemoryStats": {
        "properties": {
          "totalGB": {
            "type": "number",
            "description": "Total system memory in GB"
          },
          "availableGB": {
            "type": "number",
            "description": "Available system memory in GB"
          },
          "usedPercent": {
            "type": "number",
            "description": "Percentage of memory currently used"
          }
        },
        "type": "object",
        "required": [
          "totalGB",
          "availableGB",
          "usedPercent"
        ],
        "title": "MemoryStats",
        "description": "Memory utilization stats."
      },
      "RikAI2Request": {
        "properties": {
          "question": {
            "type": "string",
            "title": "Question",
            "description": "Single question to ask about the file"
          },
          "file": {
            "type": "string",
            "title": "File",
            "description": "Input file as a base64 encoded string"
          },
          "pageBatchSize": {
            "type": "int",
            "description": "Specifies the number of pages that are passed to the Lazarus Forms model at a time. The input document will be divided into chunks, each containing up to `pageBatchSize` pages. Must be a positive integer. Currently only supported for PDFs.",
            "default": null
          },          
          "settings": {
            "properties": {
              "advancedExplainability": {
                "type": "boolean",
                "description": "When set to `false`, the model processes requests faster but does not return the full context. Set to `true` to include full context.",
                "default": false
              },
              "returnOCR": {
                "type": "boolean",
                "description": "Set to `true` to include OCR results in response. Under construction.",
                "default": false
              },  
            },
            "type": "object",
            "title": "Settings"
          }          
        },
        "type": "object",
        "required": [
          "question",
          "file"
        ],
        "title": "RikAI2Request",
        "description": "Request body for /rikai2 endpoint"
      },
      "RikAI2Response": {
        "properties": {
          "data": {
            "$ref": "#/components/schemas/Data",
            "type": "object",
            "title": "Data",
            "description": "Question and answer pair"
          },
          "model": {
            "type": "string",
            "title": "Model",
            "description": "Name of the model"
          },
          "ocrResults": {
            "description": "OCR results from the document. Returned only if `returnOCR` was set to true in the request. Under construction.",
            "type": "object"
          },
          "timeMS": {
            "$ref": "#/components/schemas/TimeMS",
            "type": "object",
            "title": "timeMS",
            "description": "A collection of time in milliseconds spent on different parts of the request."
          },
          "timestamps": {
            "$ref": "#/components/schemas/Timestamps",
            "type": "object",
            "title": "timestamp",
            "description": "A collection of Unix timestamps in milliseconds."
          }
        },
        "type": "object",
        "required": [
          "data",
          "model"
        ],
        "title": "RikAI2Response",
        "description": "Response body for /rikai2 endpoint"
      },
      "InvalidLicenseResponse": {
        "type": "string",
        "title": "InvalidLicenseResponse",
        "description": "Invalid License Response - License was not able to successfully authenticate"
      },
      "StatusComponent": {
        "properties": {
          "status": {
            "$ref": "#/components/schemas/StatusEndpointEnum",
            "description": "Status of a specific component of the container"
          },
          "type": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/StatusComponentType"
              },
              {
                "type": "null"
              }
            ],
            "description": "Type of the component"
          },
          "error": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "description": "Error message if status is ERROR"
          }
        },
        "type": "object",
        "required": [
            "status"
        ],
        "title": "StatusComponent",
        "description": "Status of an individual component."
      },
      "StatusComponentName": {
        "type": "string",
        "enum": [
          "model",
          "ocr",
          "license"
        ],
        "title": "StatusComponentName",
        "description": "Status components."
      },
      "StatusComponentType": {
        "type": "string",
        "enum": [
          "vLLM",
          "Online License",
          "Offline License"
        ],
        "title": "StatusComponentType",
        "description": "Types of status components."
      },
      "StatusEndpointEnum": {
        "type": "string",
        "enum": [
          "OK",
          "ERROR"
        ],
        "title": "StatusEndpointEnum",
        "description": "Status values."
      },
      "StatusResponse": {
        "properties": {
          "status": {
            "$ref": "#/components/schemas/StatusEndpointEnum",
            "description": "Overall container status"
          },
          "timestamp": {
            "type": "string",
            "format": "date-time",
            "title": "Timestamp",
            "description": "ISO timestamp, UTC timezone"
          },
          "components": {
            "additionalProperties": {
                "$ref": "#/components/schemas/StatusComponent"
            },
            "propertyNames": {
                "$ref": "#/components/schemas/StatusComponentName"
            },
            "type": "object",
            "title": "Components",
            "description": "Components that make up the container status"
          },
          "cpu": {
            "$ref": "#/components/schemas/CPUStats",
            "description": "Host machine CPU utilization statistics"
          },
          "memory": {
            "$ref": "#/components/schemas/MemoryStats",
            "description": "System memory statistics (RAM)"
          },
          "disk": {
            "$ref": "#/components/schemas/DiskStats",
            "description": "Disk usage statistics"
          },
          "gpus": {
            "anyOf": [
                {
                  "items": {
                    "$ref": "#/components/schemas/GPUStats"
                  },
                  "type": "array"
                },
                {
                  "type": "null"
                }
            ],
            "description": "List of GPU devices and their utilization statistics"
          }
        },
        "type": "object",
        "required": [
          "status",
          "components",
          "timestamp",
          "cpu",
          "memory",
          "disk"
        ],
        "title": "StatusResponse",
        "description": "GET /status response body."
      },
      "StatusEnum": {
        "type": "string",
        "enum": [
          "SUCCESS",
          "FAILURE",
          "AUTH_FAILURE"
        ],
        "title": "StatusEnum",
        "description": "Status enum for responses"
      },
      "TimeMS": {
        "properties": {
          "auth": {
            "type": "int",
            "title": "auth",
            "description": "Time taken to perform authentication (ms)"
          },
          "ocr": {
            "type": "int",
            "title": "ocr",
            "description": "Time taken to run OCR (ms)"
          },
          "model": {
            "type": "int",
            "title": "model",
            "description": "Time taken to run model (ms)"
          },
          "preAuth": {
            "type": "int",
            "title": "preAuth",
            "description": "Time taken from request start to authentication (ms)"
          },
          "preOCR": {
            "type": "int",
            "title": "preOCR",
            "description": "Time taken from the previous stage to running OCR (ms)"
          },
          "preModel": {
            "type": "int",
            "title": "preModel",
            "description": "Time taken from the previous stage to running model (ms)"
          },
          "interModel": {
            "type": "int",
            "title": "interModel",
            "description": "Time taken in between multiple model calls (ms)"
          },
          "postprocessing": {
            "type": "int",
            "title": "postprocessing",
            "description": "Time taken from the previous stage to request end (ms)"
          },
          "total": {
            "type": "int",
            "title": "total",
            "description": "Time taken from request start to request end (ms)"
          }
        },
        "type": "object",
        "title": "timeMS",
        "description": "A collection of time in milliseconds spent on different parts of the request."
      },
      "Timestamps": {
        "properties": {
          "requestStart": {
            "type": "int",
            "title": "requestStart",
            "description": "Unix timestamp (ms) when a request starts"
          },
          "requestEnd": {
            "type": "int",
            "title": "requestEnd",
            "description": "Unix timestamp (ms) when a request ends"
          },
          "authStart": {
            "type": "int",
            "title": "authStart",
            "description": "Unix timestamp (ms) when authentication starts"
          },
          "authEnd": {
            "type": "int",
            "title": "authEnd",
            "description": "Unix timestamp (ms) when authentication ends"
          },
          "ocrStart": {
            "type": "int",
            "title": "ocrStart",
            "description": "Unix timestamp (ms) when OCR starts"
          },
          "ocrEnd": {
            "type": "int",
            "title": "ocrEnd",
            "description": "Unix timestamp (ms) when OCR ends"
          },
          "modelInitStart": {
            "type": "int",
            "title": "modelInitStart",
            "description": "Unix timestamp (ms) when the initial call to model starts"
          },
          "modelInitEnd": {
            "type": "int",
            "title": "modelInitEnd",
            "description": "Unix timestamp (ms) when the initial call to model ends"
          },
          "modelExpStart": {
            "type": "int",
            "title": "modelExpStart",
            "description": "Unix timestamp (ms) when the additional call to model starts, if advancedExplainability is set to true"
          },
          "modelExpEnd": {
            "type": "int",
            "title": "modelExpEnd",
            "description": "Unix timestamp (ms) when the additional call to model ends, if advancedExplainability is set to true"
          }
        },
        "type": "object",
        "title": "timestamps",
        "description": "A collection of Unix timestamps in milliseconds."
      },
    "ErrorResponse": {
        "properties": {
          "status": {
            "allOf": [
              {
                "$ref": "#/components/schemas/StatusEnum"
              }
            ],
            "title": "status",
            "description": "Status of the request."
          },
          "message": {
            "type": "string",
            "title": "message",
            "description": "Error message."
          }
        },
        "type": "object",
        "required": [
          "status"
        ],
        "title": "ErrorResponse",
        "description": "Response when an error occurs."
      }
    }
  },
  "servers": [
    {
      "url": "https://<hostname>:8080",
      "description": ""
    }
  ]

}